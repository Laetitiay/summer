literally copied the algorithm form wikipedia 1:1
